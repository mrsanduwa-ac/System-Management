<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Out Fashion</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes animateGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        body { 
            font-family: 'Inter', sans-serif;
            background: linear-gradient(-45deg, #0f0c29, #302b63, #24243e, #0f0c29);
            background-size: 600% 600%;
            animation: animateGradient 25s ease infinite;
            color: #e2e8f0; 
        }
        .overflow-y-auto::-webkit-scrollbar { width: 8px; }
        .overflow-y-auto::-webkit-scrollbar-track { background: #2d3748; }
        .overflow-y-auto::-webkit-scrollbar-thumb { background: #4a5568; border-radius: 10px; }

        .card {
            background-color: rgba(26, 32, 44, 0.7); /* Darker Semi-transparent card */
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2); }
        .status-message { transition: all 0.5s ease-in-out; overflow: hidden; max-height: 0; padding: 0; margin-top: 0; opacity: 0; }
        .status-message.show { max-height: 100px; padding: 0.5rem; margin-top: 0.75rem; opacity: 1; }
        .auto-save-status { opacity: 0; transition: opacity 0.5s ease; color: #48bb78; }
        .auto-save-status.show { opacity: 1; }

        /* Dark Theme Styles */
        .text-primary { color: #e2e8f0; }
        .text-secondary { color: #a0aec0; }
        .bg-card-section { background-color: rgba(45, 55, 72, 0.5); }
        .border-theme { border-color: rgba(255, 255, 255, 0.1); }
        .btn-primary{background-color:#4299e1;color:#fff}.btn-primary:hover{background-color:#2b6cb0}
        .btn-secondary{background-color:#4a5568;color:#e2e8f0;border:1px solid #718096}.btn-secondary:hover{background-color:#2d3748}
        .btn-danger{background-color:#e53e3e;color:#fff}.btn-danger:hover{background-color:#c53030}
        .btn-info{background-color:#5a67d8;color:#fff}.btn-info:hover{background-color:#4c51bf}
        .btn-success{background-color:#38a169;color:#fff}.btn-success:hover{background-color:#2f855a}
        #langSinhalaBtn, #langEnglishBtn { background-color: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.2); color: #a0aec0;}
        #langSinhalaBtn.active, #langEnglishBtn.active { background-color: #4299e1; color: white; border-color: #4299e1; }
        .bg-green-status{background-color:#2f855a;border:1px solid #38a169;color:#c6f6d5}
        .bg-red-status{background-color:#c53030;border:1px solid #e53e3e;color:#fed7d7}
        input, select, textarea { background-color: #1a202c; border-color: #4a5568; color: #e2e8f0; }
        input::placeholder, textarea::placeholder { color: #718096; }
        input[type="date"]::-webkit-calendar-picker-indicator { filter: invert(0.8); cursor: pointer; }
        
        @media print {
            body>*:not(#print-area){display:none!important}#print-area{display:block!important;position:absolute;left:0;top:0;width:100%;padding:8mm;box-sizing:border-box;font-family:'Times New Roman',Times,serif;color:#000;background-color:#fff}.no-print{display:none!important}.print-header{text-align:center;margin-bottom:10px}.print-header .company-name{font-family:'Impact',Haettenschweiler,'Arial Narrow Bold',sans-serif;font-size:16pt;letter-spacing:1px}.print-header .report-title{font-size:14pt;font-weight:700;margin-top:5px;padding-bottom:5px;border-bottom:2px solid #333}.print-details-container{margin-bottom:12px;font-size:10pt;border:1px solid #ccc;padding:10px}.print-details-container p{margin:4px 0}#printCustomNote.empty{display:none}#printCustomNote{margin-top:8px!important;padding-top:8px;border-top:1px dashed #ccc;font-style:italic}.barcode-list-header{font-size:12pt;font-weight:700;margin-bottom:6px}#printBarcodeList{column-count:4;column-gap:20px;list-style:none;padding:0;margin:0;font-size:9pt;column-fill:auto}#printBarcodeList>div{break-inside:avoid-column;margin-bottom:4px;padding:2px 0;white-space:nowrap}.print-footer{position:fixed;bottom:5mm;left:8mm;right:8mm;text-align:center;font-size:8pt;color:#666;border-top:1px solid #ccc;padding-top:5px}
        }
    </style>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body class="min-h-screen flex items-center justify-center p-4 lg:p-8">

    <div class="card p-6 lg:p-8 rounded-2xl shadow-2xl w-full max-w-7xl no-print">
        <div class="flex justify-between items-center mb-6 flex-wrap gap-4">
            <h1 class="text-2xl lg:text-3xl font-extrabold">
                <span id="appTitle" class="bg-clip-text text-transparent bg-gradient-to-r from-blue-300 to-purple-400"></span>
            </h1>
            <div id="live-clock" class="text-xl lg:text-2xl font-bold text-slate-300 order-3 lg:order-2 w-full lg:w-auto text-center"></div>
            <div class="flex gap-2 order-2 lg:order-3">
                <button id="langSinhalaBtn" class="px-3 py-1 rounded-full text-sm font-semibold border transition-colors"></button>
                <button id="langEnglishBtn" class="px-3 py-1 rounded-full text-sm font-semibold border transition-colors"></button>
            </div>
        </div>
        
        <div class="flex flex-col lg:flex-row gap-8 mt-4">
            <!-- Left Column -->
            <div class="w-full lg:w-3/5 flex flex-col gap-y-6">
                <p id="scanOrderDescription" class="text-center text-secondary -mt-2"></p>
                <div class="p-4 bg-blue-900/30 rounded-lg border border-blue-700/50 text-center shadow-md">
                    <p class="text-xl font-semibold text-blue-200">
                        <span id="uniqueOrderCountLabel"></span>:
                        <span id="uniqueOrderCount" class="text-purple-400 text-2xl font-bold">0</span>
                    </p>
                </div>
                <div>
                     <div class="flex flex-col sm:flex-row gap-4">
                        <input type="text" id="orderScanInput" class="flex-grow p-3 border-2 border-blue-500 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 transition duration-200 shadow-sm" />
                        <button id="addOrderBarcodeBtn" class="px-6 py-3 rounded-lg font-semibold shadow-md transition transform hover:scale-105 btn-primary"></button>
                    </div>
                    <div id="statusMessage" class="status-message rounded-lg text-center font-semibold p-2"></div>
                </div>
                <div>
                    <h2 id="scannedOrderTitle" class="text-2xl font-bold text-primary mb-4 border-b border-theme pb-2"></h2>
                    <div id="orderListContainer" class="bg-card-section p-4 rounded-lg border border-theme max-h-60 lg:max-h-96 overflow-y-auto shadow-inner">
                        <ul id="scannedOrderBarcodesList" class="space-y-2">
                            <p id="noOrderBarcodesMessage" class="text-secondary text-center py-4"></p>
                        </ul>
                    </div>
                </div>
                 <button id="clearCurrentOrderBtn" class="w-full px-6 py-3 rounded-lg font-semibold shadow-md transition transform hover:scale-105 btn-secondary"></button>
            </div>

            <!-- Right Column -->
            <div class="w-full lg:w-2/5 flex flex-col gap-y-8">
                <div class="p-6 bg-card-section rounded-xl border border-theme shadow-inner h-fit">
                     <h2 id="exportTitle" class="text-2xl font-bold text-primary mb-4 border-b border-theme pb-2"></h2>
                     <div class="mb-4">
                        <label id="customPrintTitleLabel" for="customPrintTitle" class="block mb-2 text-sm font-medium text-secondary"></label>
                        <input type="text" id="customPrintTitle" class="w-full p-2 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500">
                     </div>
                     <div class="mb-4">
                        <label id="customPrintNoteLabel" for="customPrintNote" class="block mb-2 text-sm font-medium text-secondary"></label>
                        <textarea id="customPrintNote" rows="2" class="w-full p-2 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"></textarea>
                     </div>
                     <button id="printScannedOrderBtn" class="w-full px-6 py-3 rounded-lg font-semibold shadow-md transition transform hover:scale-105 btn-info"></button>
                     <button id="downloadCsvBtn" class="mt-4 w-full px-6 py-3 rounded-lg font-semibold shadow-md transition transform hover:scale-105 btn-success"></button>
                </div>
                <div class="p-6 bg-card-section rounded-xl border border-theme shadow-inner h-fit">
                    <div class="flex justify-between items-center mb-4">
                        <h2 id="loadPreviousOrdersTitle" class="text-2xl font-bold text-primary border-b border-theme pb-2"></h2>
                        <span id="autoSaveStatus" class="auto-save-status font-semibold">✓ Saved</span>
                    </div>
                    <div class="mb-4">
                         <label id="searchByDateLabel" for="searchByDate" class="block mb-2 text-sm font-medium text-secondary"></label>
                         <div class="flex gap-2">
                            <input type="date" id="searchByDate" class="w-full p-2 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500">
                            <button id="resetDateFilterBtn" class="px-4 py-2 rounded-lg font-semibold shadow-md transition transform hover:scale-105 btn-secondary text-xs"></button>
                         </div>
                    </div>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <select id="savedSessionsSelect" class="flex-grow p-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500"><option value=""></option></select>
                        <button id="loadSelectedSessionBtn" class="px-6 py-3 rounded-lg font-semibold shadow-md transition transform hover:scale-105 btn-primary"></button>
                    </div>
                    <button id="deleteSelectedSessionBtn" class="mt-4 w-full px-6 py-3 rounded-lg font-semibold shadow-md transition transform hover:scale-105 btn-danger"></button>
                </div>
            </div>
        </div>
    </div>

    <!-- PRINT AREA -->
    <div id="print-area" class="hidden">
        <div class="print-header"> <p class="company-name">World Out Fashion</p> <h1 class="report-title" id="printReportTitle"></h1> </div>
        <div class="print-details-container"> <p><strong><span id="printSessionLabel"></span></strong> <span id="printSessionName"></span></p> <p><strong><span id="printDateLabel"></span></strong> <span id="printDate"></span></p> <p id="printCustomNote" class="empty"><strong><span id="printNoteLabel"></span></strong> <span></span></p> </div>
        <p class="barcode-list-header" id="printExpectedItemsTitle"></p>
        <div id="printBarcodeList"></div>
        <div class="print-footer">Generated by Order Management System</div>
    </div>

    <script>
        let currentLanguage = localStorage.getItem('appLanguage') || 'si';
        let scannedUniqueBarcodes = new Set();
        let currentSessionId = null;
        const el = {
            statusMessage:document.getElementById("statusMessage"),customPrintTitle:document.getElementById("customPrintTitle"),customPrintNote:document.getElementById("customPrintNote"),appTitle:document.getElementById("appTitle"),langSinhalaBtn:document.getElementById("langSinhalaBtn"),langEnglishBtn:document.getElementById("langEnglishBtn"),scanOrderDescription:document.getElementById("scanOrderDescription"),uniqueOrderCountLabel:document.getElementById("uniqueOrderCountLabel"),uniqueOrderCount:document.getElementById("uniqueOrderCount"),orderScanInput:document.getElementById("orderScanInput"),addOrderBarcodeBtn:document.getElementById("addOrderBarcodeBtn"),scannedOrderTitle:document.getElementById("scannedOrderTitle"),scannedOrderBarcodesList:document.getElementById("scannedOrderBarcodesList"),noOrderBarcodesMessage:document.getElementById("noOrderBarcodesMessage"),orderListContainer:document.getElementById("orderListContainer"),clearCurrentOrderBtn:document.getElementById("clearCurrentOrderBtn"),exportTitle:document.getElementById("exportTitle"),customPrintTitleLabel:document.getElementById("customPrintTitleLabel"),customPrintNoteLabel:document.getElementById("customPrintNoteLabel"),printScannedOrderBtn:document.getElementById("printScannedOrderBtn"),downloadCsvBtn:document.getElementById("downloadCsvBtn"),loadPreviousOrdersTitle:document.getElementById("loadPreviousOrdersTitle"),savedSessionsSelect:document.getElementById("savedSessionsSelect"),loadSelectedSessionBtn:document.getElementById("loadSelectedSessionBtn"),deleteSelectedSessionBtn:document.getElementById("deleteSelectedSessionBtn"),liveClock:document.getElementById("live-clock"),searchByDateLabel:document.getElementById("searchByDateLabel"),searchByDate:document.getElementById("searchByDate"),resetDateFilterBtn:document.getElementById("resetDateFilterBtn"),autoSaveStatus:document.getElementById("autoSaveStatus"),
        };
        const LOCAL_STORAGE_KEY = 'barcodeApp_savedSessions_v5';
        const translations = {
            si:{appTitle:"ඇණවුම් කළමනාකරණ පද්ධතිය",scanOrderDescription:"ඇණවුම් අයිතම ස්කෑන් කරන්න.",uniqueOrderCountLabel:"අද්විතීය බාර්කෝඩ්",orderScanInputPlaceholder:"බාර්කෝඩ් අංකය...",addOrderBarcodeBtn:"ස්කෑන් කරන්න",scannedOrderTitle:"ස්කෑන් කළ බාර්කෝඩ්",noOrderBarcodesMessage:"බාර්කෝඩ් ස්කෑන් කර නැත.",clearCurrentOrderBtn:"වත්මන් ඇණවුම හිස් කරන්න",exportTitle:"බාගත කිරීම සහ සැකසීම",customPrintTitleLabel:"මුද්‍රණය සඳහා නම",customPrintTitlePlaceholder:"උදා: පාරිභෝගික ඇණවුම #123",customPrintNoteLabel:"මුද්‍රණය සඳහා සටහන",customPrintNotePlaceholder:"සටහනක් එක් කරන්න...",printScannedOrderBtn:"ඇණවුම මුද්‍රණය කරන්න (A4)",downloadCsvBtn:"CSV බාගත කරන්න",loadPreviousOrdersTitle:"පෙර ඇණවුම්",searchByDateLabel:"දිනය අනුව සොයන්න",resetDateFilterBtn:"Reset",savedSessionsSelectPlaceholder:"සුරකින ලද සැසියක් තෝරන්න",loadSelectedSessionBtn:"පූරණය කරන්න",deleteSelectedSessionBtn:"මකා දමන්න",scannedSuccessfully:b=>`සාර්ථකයි: ${b}`,duplicateScan:b=>`දැනටමත් ඇත: ${b}`,alertSelectSession:"සැසියක් තෝරන්න.",alertSessionLoaded:n=>`'${n}' පූරණය විය.`,alertDeleteConfirm:"මෙම සැසිය මකා දැමීමට අවශ්‍යද?",alertSessionDeleted:"සැසිය මකා දැමිණි.",alertCurrentOrderCleared:"වත්මන් දත්ත හිස් කරන ලදී.",printReportTitle:"ස්කෑන් කළ ඇණවුම් වාර්තාව",printSessionLabel:"සැසිය:",printDateLabel:"දිනය:",printNoteLabel:"සටහන:",printExpectedItemsTitle:"ස්කෑන් කළ බාර්කෝඩ්:",sessionNamePrefix:"සැසිය"},
            en:{appTitle:"Order Management System",scanOrderDescription:"Scan order items.",uniqueOrderCountLabel:"Unique Barcodes",orderScanInputPlaceholder:"Barcode number...",addOrderBarcodeBtn:"Scan",scannedOrderTitle:"Scanned Barcodes",noOrderBarcodesMessage:"No barcodes scanned.",clearCurrentOrderBtn:"Clear Current Order",exportTitle:"Export & Customize",customPrintTitleLabel:"Custom Title for Print",customPrintTitlePlaceholder:"e.g., Customer Order #123",customPrintNoteLabel:"Custom Note for Print",customPrintNotePlaceholder:"Add a note...",printScannedOrderBtn:"Print Order (A4)",downloadCsvBtn:"Download CSV",loadPreviousOrdersTitle:"Load Previous Orders",searchByDateLabel:"Search by Date",resetDateFilterBtn:"Reset",savedSessionsSelectPlaceholder:"Select a saved session",loadSelectedSessionBtn:"Load",deleteSelectedSessionBtn:"Delete",scannedSuccessfully:b=>`Success: ${b}`,duplicateScan:b=>`Already Scanned: ${b}`,alertSelectSession:"Please select a session.",alertSessionLoaded:n=>`'${n}' loaded.`,alertDeleteConfirm:"Are you sure you want to delete this session?",alertSessionDeleted:"Session deleted.",alertCurrentOrderCleared:"Current data cleared.",printReportTitle:"Scanned Order Report",printSessionLabel:"Session:",printDateLabel:"Date:",printNoteLabel:"Note:",printExpectedItemsTitle:"Scanned Barcodes:",sessionNamePrefix:"Session"}
        };
        function getTimestamp(t){const e=t?new Date(parseInt(t,10)):new Date;return e.toLocaleString("si"===currentLanguage?"si-LK":"en-US",{dateStyle:"short",timeStyle:"short",hour12:!1})}
        function updateClock(){el.liveClock.textContent=(new Date).toLocaleString("si"===currentLanguage?"si-LK":"en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}
        function showStatusMessage(t,e){el.statusMessage.textContent=t,el.statusMessage.className="status-message rounded-lg text-center font-semibold p-2",el.statusMessage.classList.add("success"===e?"bg-green-status":"bg-red-status","show"),setTimeout(()=>el.statusMessage.classList.remove("show"),2500)}
        function applyTranslations(){const t=translations[currentLanguage];document.documentElement.lang=currentLanguage,Object.keys(t).forEach(e=>{el[e]&&"object"==typeof el[e]&&void 0!==el[e].textContent&&(el[e].textContent=t[e])}),el.orderScanInput.placeholder=t.orderScanInputPlaceholder,el.customPrintTitle.placeholder=t.customPrintTitlePlaceholder,el.customPrintNote.placeholder=t.customPrintNotePlaceholder,el.savedSessionsSelect.querySelector("option").textContent=t.savedSessionsSelectPlaceholder,renderPermanentBarcodes(),filterSessionsByDate()}
        function setLanguage(t){currentLanguage=t,localStorage.setItem("appLanguage",t),applyTranslations(),el.langSinhalaBtn.classList.toggle("active","si"===t),el.langEnglishBtn.classList.toggle("active","en"===t)}
        function renderPermanentBarcodes(){el.scannedOrderBarcodesList.innerHTML="";const t=scannedUniqueBarcodes.size>0;el.noOrderBarcodesMessage.classList.toggle("hidden",!t),t&&(Array.from(scannedUniqueBarcodes).reverse().forEach((t,e)=>{const o=document.createElement("li");o.className="flex items-center justify-between p-2 rounded-md shadow-sm border text-lg font-medium bg-gray-700/50 border-gray-600/50 text-gray-200",o.innerHTML=`<span>${t}</span><span class="text-sm text-gray-400">#${scannedUniqueBarcodes.size-e}</span>`,el.scannedOrderBarcodesList.appendChild(o)}),el.orderListContainer.scrollTop=0),el.uniqueOrderCount.textContent=scannedUniqueBarcodes.size}
        function handleOrderScanAddBarcode(){const t=el.orderScanInput.value.trim();if(""===t)return;const e=translations[currentLanguage];scannedUniqueBarcodes.has(t)?showStatusMessage(e.duplicateScan(t),"error"):(scannedUniqueBarcodes.add(t),showStatusMessage(e.scannedSuccessfully(t),"success"),renderPermanentBarcodes(),autoSaveSession()),el.orderScanInput.value="",el.orderScanInput.focus()}
        async function autoSaveSession(){if(0===scannedUniqueBarcodes.size)return;try{let t=JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY)||"[]");currentSessionId&&t.some(t=>t.id===currentSessionId)?t=t.map(t=>t.id===currentSessionId?{...t,data:{uniqueBarcodes:Array.from(scannedUniqueBarcodes)}}:t):(currentSessionId=Date.now().toString(),t.push({id:currentSessionId,name:`${translations[currentLanguage].sessionNamePrefix} - ${getTimestamp(currentSessionId)}`,createdAt:parseInt(currentSessionId,10),data:{uniqueBarcodes:Array.from(scannedUniqueBarcodes)}})),localStorage.setItem(LOCAL_STORAGE_KEY,JSON.stringify(t)),await filterSessionsByDate(),el.autoSaveStatus.classList.add("show"),setTimeout(()=>{el.autoSaveStatus.classList.remove("show")},2e3)}catch(t){console.error("Auto-save error:",t)}}
        function loadSavedSessionsDropdown(t){const e=t||JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY)||"[]");el.savedSessionsSelect.innerHTML=`<option value="">${translations[currentLanguage].savedSessionsSelectPlaceholder}</option>`,e.sort((t,e)=>(e.createdAt||0)-(t.createdAt||0)).forEach(t=>{const e=document.createElement("option");e.value=t.id,e.textContent=t.name,el.savedSessionsSelect.appendChild(e)}),el.savedSessionsSelect.value=currentSessionId||""}
        function filterSessionsByDate(){const t=el.searchByDate.value,e=JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY)||"[]");if(!t)return void loadSavedSessionsDropdown(e);const o=e.filter(e=>{const o=e.createdAt||parseInt(e.id,10);return(new Date(o)).toLocaleDateString("en-CA")===t});loadSavedSessionsDropdown(o)}
        function loadSelectedSession(){const t=el.savedSessionsSelect.value;if(!t)return void alert(translations[currentLanguage].alertSelectSession);const e=JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY)||"[]").find(e=>e.id===t);e&&(currentSessionId=e.id,scannedUniqueBarcodes=new Set(e.data.uniqueBarcodes||[]),el.searchByDate.value="",alert(translations[currentLanguage].alertSessionLoaded(e.name)),renderPermanentBarcodes(),filterSessionsByDate())}
        function deleteSelectedSession(){const t=el.savedSessionsSelect.value;if(!t)return void alert(translations[currentLanguage].alertSelectSession);confirm(translations[currentLanguage].alertDeleteConfirm)&&(localStorage.setItem(LOCAL_STORAGE_KEY,JSON.stringify(JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY)||"[]").filter(e=>e.id!==t))),alert(translations[currentLanguage].alertSessionDeleted),currentSessionId===t&&clearCurrentOrder(!1),filterSessionsByDate())}
        function clearCurrentOrder(t=!0){scannedUniqueBarcodes.clear(),currentSessionId=null,renderPermanentBarcodes(),t&&alert(translations[currentLanguage].alertCurrentOrderCleared)}
        function printScannedOrder(){if(0===scannedUniqueBarcodes.size)return void alert(translations[currentLanguage].noOrderBarcodesMessage);const t=translations[currentLanguage];document.getElementById("printReportTitle").textContent=el.customPrintTitle.value.trim()||t.printReportTitle,document.getElementById("printSessionName").textContent=el.savedSessionsSelect.options[el.savedSessionsSelect.selectedIndex]?.textContent||"Current Session",document.getElementById("printDate").textContent=getTimestamp(),document.getElementById("printSessionLabel").textContent=t.printSessionLabel,document.getElementById("printDateLabel").textContent=t.printDateLabel,document.getElementById("printExpectedItemsTitle").textContent=t.printExpectedItemsTitle,document.getElementById("printNoteLabel").textContent=t.printNoteLabel;const e=document.getElementById("printCustomNote"),o=el.customPrintNote.value.trim();e.querySelector("span").textContent=o,e.classList.toggle("empty",!o);const n=document.getElementById("printBarcodeList");n.innerHTML="",Array.from(scannedUniqueBarcodes).forEach((t,e)=>{const o=document.createElement("div");o.textContent=`${e+1}. ${t}`,n.appendChild(o)}),window.print()}
        function downloadCsv(){if(0===scannedUniqueBarcodes.size)return void alert(translations[currentLanguage].noOrderBarcodesMessage);const t="Barcode\n"+Array.from(scannedUniqueBarcodes).join("\n"),e=document.createElement("a");e.href=URL.createObjectURL(new Blob([t],{type:"text/csv;charset=utf-8;"})),e.download=`scanned_order_${Date.now()}.csv`,e.click()}
        document.addEventListener("DOMContentLoaded",()=>{setLanguage(currentLanguage),updateClock(),setInterval(updateClock,1e3),el.langSinhalaBtn.addEventListener("click",()=>setLanguage("si")),el.langEnglishBtn.addEventListener("click",()=>setLanguage("en")),el.orderScanInput.addEventListener("keypress",t=>"Enter"===t.key&&handleOrderScanAddBarcode()),el.addOrderBarcodeBtn.addEventListener("click",handleOrderScanAddBarcode),el.clearCurrentOrderBtn.addEventListener("click",()=>clearCurrentOrder(!0)),el.printScannedOrderBtn.addEventListener("click",printScannedOrder),el.downloadCsvBtn.addEventListener("click",downloadCsv),el.loadSelectedSessionBtn.addEventListener("click",loadSelectedSession),el.deleteSelectedSessionBtn.addEventListener("click",deleteSelectedSession),el.searchByDate.addEventListener("input",filterSessionsByDate),el.resetDateFilterBtn.addEventListener("click",()=>{el.searchByDate.value="",filterSessionsByDate()})});
    </script>
<audio id="successSound" src="https://drive.google.com/file/d/1Z4Sz_uy2PM4wICh2mArJY3wS0UyPsvOt/view?usp=drive_link" preload="auto"></audio>
</body>
</html>
